

/*************************************************************************
 * Copyright (c) 2011 AT&T Intellectual Property
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors: See CVS logs. Details at http://www.graphviz.org/
 *************************************************************************/

#ifndef GV_RENDER_H
#define GV_RENDER_H

#ifdef __cplusplus
extern "C" {
#endif

#ifdef HAVE_CONFIG_H
#include "config.h"
#endif

#ifdef HAVE_SYS_TYPES_H
#include <sys/types.h>
#endif
#ifdef HAVE_STDLIB_H
#include <stdlib.h>
#endif
#ifdef HAVE_STDDEF_H
#include <stddef.h>
#endif
#ifdef HAVE_STRINGS_H
#include <strings.h>
#endif
#ifdef HAVE_STRING_H
#include <string.h>
#endif

#include "types.h"
#include "macros.h"
#include "const.h"
#include "globals.h"
#include "memory.h"
#include "colorprocs.h" /* must collow color.h (in types.h) */
#include "geomprocs.h"  /* must follow geom.h (in types.h) */
#include "agxbuf.h"
#include "utils.h"    /* must follow types.h and agxbuf.h */
#include "gvplugin.h" /* must follow gvcext.h (in types.h) */
#include "gvcjob.h"   /* must follow gvcext.h (in types.h) */
#include "gvcint.h"   /* must follow gvcext.h (in types.h) */
#include "gvcproc.h"  /* must follow gvcext.h (in types.h) */

typedef struct epsf_s {
  int macro_id;
  point offset;
} epsf_t;

typedef void (*nodesizefn_t)(Agnode_t *, boolean);

/*visual studio*/
#ifdef WIN32
#ifndef GVC_EXPORTS
#define extern __declspec(dllimport)
#endif
#endif
/*end visual studio*/

extern void add_box(path *, boxf);
extern void arrow_flags(Agedge_t *e, int *sflag, int *eflag);
extern boxf arrow_bb(pointf p, pointf u, double arrowsize, int flag);
extern void arrow_gen(GVJ_t *job, emit_state_t emit_state, pointf p, pointf u,
                      double arrowsize, double penwidth, int flag);
extern double arrow_length(edge_t *e, int flag);
extern int arrowEndClip(edge_t *, pointf *, int, int, bezier *, int eflag);
extern int arrowStartClip(edge_t *, pointf *ps, int, int, bezier *, int sflag);
extern void arrowOrthoClip(edge_t *, pointf *ps, int, int, bezier *, int sflag,
                           int eflag);
extern void beginpath(path *, Agedge_t *, int, pathend_t *, boolean);
extern void bezier_clip(inside_t *inside_context,
                        boolean (*insidefn)(inside_t *inside_context, pointf p),
                        pointf *sp, boolean left_inside);
extern shape_desc *bind_shape(char *name, node_t *);
extern void makeStraightEdge(graph_t *g, edge_t *e, int edgetype,
                             splineInfo *info);
extern void makeStraightEdges(graph_t *g, edge_t **edges, int e_cnt, int et,
                              splineInfo *sinfo);
extern void clip_and_install(edge_t *fe, node_t *hn, pointf *ps, int pn,
                             splineInfo *info);
extern char *charsetToStr(int c);
extern pointf coord(node_t *n);
extern void do_graph_label(graph_t *sg);
extern void graph_init(graph_t *g, boolean use_rankdir);
extern void graph_cleanup(graph_t *g);
extern int dotneato_args_initialize(GVC_t *gvc, int, char **);
extern int dotneato_usage(int);
extern void dotneato_postprocess(Agraph_t *);
extern void gv_postprocess(Agraph_t *, int);
extern void dotneato_set_margins(GVC_t *gvc, Agraph_t *);
extern void dotneato_write(GVC_t *gvc, graph_t *g);
extern void dotneato_write_one(GVC_t *gvc, graph_t *g);
extern Ppolyline_t *ellipticWedge(pointf ctr, double major, double minor,
                                  double angle0, double angle1);
extern void emit_clusters(GVJ_t *job, Agraph_t *g, int flags);
extern char *getObjId(GVJ_t *job, void *obj, agxbuf *xb);
/* extern void emit_begin_edge(GVJ_t * job, edge_t * e, char**); */
/* extern void emit_end_edge(GVJ_t * job); */
extern void emit_graph(GVJ_t *job, graph_t *g);
extern void emit_label(GVJ_t *job, emit_state_t emit_state, textlabel_t *);
extern int emit_once(char *message);
extern void emit_jobs_eof(GVC_t *gvc);
extern void emit_map_rect(GVJ_t *job, boxf b);
extern void enqueue_neighbors(nodequeue *, Agnode_t *, int);
extern void endpath(path *, Agedge_t *, int, pathend_t *, boolean);
extern void epsf_init(node_t *n);
extern void epsf_free(node_t *n);
extern shape_desc *find_user_shape(const char *);
extern void free_line(textspan_t *);
extern void free_label(textlabel_t *);
extern void free_textspan(textspan_t *tl, int);
extern void getdouble(graph_t *g, char *name, double *result);
extern splines *getsplinepoints(edge_t *e);
extern void gv_fixLocale(int set);
extern void gv_free_splines(edge_t *e);
extern void gv_cleanup_edge(Agedge_t *e);
extern void gv_cleanup_node(Agnode_t *n);
extern void *init_xdot(Agraph_t *g);
extern int initMapData(GVJ_t *, char *, char *, char *, char *, char *, void *);
extern boolean isPolygon(node_t *);
extern void makeSelfEdge(path *P, edge_t *edges[], int ind, int cnt,
                         double sizex, double sizey, splineInfo *sinfo);
extern textlabel_t *make_label(void *obj, char *str, int kind, double fontsize,
                               char *fontname, char *fontcolor);
extern bezier *new_spline(edge_t *e, int sz);
extern char **parse_style(char *s);
extern void place_graph_label(Agraph_t *);
extern int place_portlabel(edge_t *e, boolean head_p);
extern void makePortLabels(edge_t *e);
extern pointf edgeMidpoint(graph_t *g, edge_t *e);
extern void addEdgeLabels(graph_t *g, edge_t *e, pointf rp, pointf rq);
extern void pop_obj_state(GVJ_t *job);
extern obj_state_t *push_obj_state(GVJ_t *job);
extern int rank(graph_t *g, int balance, int maxiter);
extern port resolvePort(node_t *n, node_t *other, port *oldport);
extern void resolvePorts(edge_t *e);
extern void round_corners(GVJ_t *job, pointf *AF, int sides, int style,
                          int filled);
extern int routesplinesinit(void);
extern pointf *routesplines(path *, int *);
extern void routesplinesterm(void);
extern pointf *simpleSplineRoute(pointf, pointf, Ppoly_t, int *, int);
extern pointf *routepolylines(path *pp, int *npoints);
extern int selfRightSpace(edge_t *e);
extern void setup_graph(GVC_t *gvc, graph_t *g);
extern shape_kind shapeOf(node_t *);
extern void shape_clip(node_t *n, pointf curve[4]);
extern void make_simple_label(GVC_t *gvc, textlabel_t *rv);
extern int stripedBox(GVJ_t *job, pointf *AF, char *clrs, int rotate);
extern stroke_t *taper(bezier *, double (*radfunc_t)(double, double, double),
                       double initwid, int linejoin, int linecap);
extern stroke_t *taper0(bezier *bez, double initwid);
extern pointf textspan_size(GVC_t *gvc, textspan_t *span);
extern Dt_t *textfont_dict_open(GVC_t *gvc);
extern void textfont_dict_close(GVC_t *gvc);
extern void translate_bb(Agraph_t *, int);
extern int wedgedEllipse(GVJ_t *job, pointf *pf, char *clrs);
extern void update_bb_bz(boxf *bb, pointf *cp);
extern void write_attributed_dot(graph_t *g, FILE *f);
extern void write_canonical_dot(graph_t *g, FILE *f);
extern boxf xdotBB(graph_t *g);
extern char *findAttrColor(void *obj, attrsym_t *colorattr, char *dflt);

#undef extern

#ifdef __cplusplus
}
#endif

#endif
